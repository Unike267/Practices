%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Masters/Doctoral Thesis 
% LaTeX Template
% Version 2.5 (27/8/17)
%
% This template was downloaded from:
% http://www.LaTeXTemplates.com
%
% Version 2.x major modifications by:
% Vel (vel@latextemplates.com)
%
% This template is based on a template by:
% Steve Gunn (http://users.ecs.soton.ac.uk/srg/softwaretools/document/templates/)
% Sunil Patel (http://www.sunilpatel.co.uk/thesis-template/)
%
% Template license:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[
11pt, % The default document font size, options: 10pt, 11pt, 12pt
%oneside, % Two side (alternating margins) for binding by default, uncomment to switch to one side
spanish, % ngerman for German
singlespacing, % Single line spacing, alternatives: onehalfspacing or doublespacing
%draft, % Uncomment to enable draft mode (no pictures, no links, overfull hboxes indicated)
%nolistspacing, % If the document is onehalfspacing or doublespacing, uncomment this to set spacing in lists to single
%liststotoc, % Uncomment to add the list of figures/tables/etc to the table of contents
%toctotoc, % Uncomment to add the main table of contents to the table of contents
%parskip, % Uncomment to add space between paragraphs
%nohyperref, % Uncomment to not load the hyperref package
headsepline, % Uncomment to get a line under the header
%chapterinoneline, % Uncomment to place the chapter title next to the number on one line
%consistentlayout, % Uncomment to change the layout of the declaration, abstract and acknowledgements pages to match the default layout
]{MastersDoctoralThesis} % The class file specifying the document structure

\usepackage[utf8]{inputenc} % Required for inputting international characters
\usepackage[T1]{fontenc} % Output font encoding for international characters

\usepackage{mathpazo} % Use the Palatino font by default

\usepackage[backend=bibtex,style=ieee,natbib=true]{biblatex} % Use the bibtex backend with the authoryear citation style (which resembles APA)

\addbibresource{references.bib} % The filename of the bibliography

\usepackage[autostyle=true]{csquotes} % Required to generate language-dependent quotes in the bibliography
\usepackage[skip=4pt plus1pt, indent=15pt]{parskip}
\usepackage{pdfpages}
\usepackage{amsmath}
\usepackage[
    left = \flqq{},% 
    right = \frqq{},% 
    leftsub = \flq{},% 
    rightsub = \frq{} %
]{dirtytalk}
\usepackage{multirow}
\usepackage{diagbox}
\usepackage[chapter, newfloat]{minted} % Code listings, with syntax highlighting
\usepackage[font=small]{caption}
\usepackage{float}
\usepackage{tablefootnote} % for table footnotes

\newenvironment{code}{\captionsetup{type=listing}}{}
\SetupFloatingEnvironment{listing}{name=Código}

%----------------------------------------------------------------------------------------
%	MARGIN SETTINGS
%----------------------------------------------------------------------------------------

\geometry{
	paper=a4paper, % Change to letterpaper for US letter
	inner=2.5cm, % Inner margin
	outer=3.8cm, % Outer margin
	bindingoffset=.5cm, % Binding offset
	top=1.5cm, % Top margin
	bottom=1.5cm, % Bottom margin
	%showframe, % Uncomment to show how the type block is set on the page
}

%----------------------------------------------------------------------------------------
%	THESIS INFORMATION
%----------------------------------------------------------------------------------------

\thesistitle{Integración y caracterización del rendimiento de unidades coprocesadoras en núcleo RISC-V para aplicaciones de IA} % Your thesis title, this is used in the title and abstract, print it elsewhere with \ttitle
\supervisor{Dr. Koldo \textsc{Basterretxea Oyarzabal}} % Your supervisor's name, this is used in the title page, print it elsewhere with \supname
\examiner{} % Your examiner's name, this is not currently used anywhere in the template, print it elsewhere with \examname
\degree{Master en Sistemas Electrónicos Avanzados} % Your degree name, this is used in the title page and abstract, print it elsewhere with \degreename
\author{Unai \textsc{Sainz Estebanez}} % Your name, this is used in the title page and abstract, print it elsewhere with \authorname
\addresses{} % Your address, this is not currently used anywhere in the template, print it elsewhere with \addressname

\subject{Electrónica Digital} % Your subject area, this is not currently used anywhere in the template, print it elsewhere with \subjectname
\keywords{} % Keywords for your thesis, this is not currently used anywhere in the template, print it elsewhere with \keywordnames
\university{\href{https://www.ehu.eus}{Universidad del País Vasco}} % Your university's name and URL, this is used in the title page and abstract, print it elsewhere with \univname
\department{} % Your department's name and URL, this is used in the title page and abstract, print it elsewhere with \deptname
\group{\href{https://www.ehu.eus/es/web/gded}{Grupo de Investigación de Diseño en Electrónica Digital}} % Your research group's name and URL, this is used in the title page, print it elsewhere with \groupname
\faculty{} % Your faculty's name and URL, this is used in the title page and abstract, print it elsewhere with \facname

\AtBeginDocument{
\hypersetup{pdftitle=\ttitle} % Set the PDF's title to your title
\hypersetup{pdfauthor=\authorname} % Set the PDF's author to your name
\hypersetup{pdfkeywords=\keywordnames} % Set the PDF's keywords to your keywords
}

\begin{document}

% Ajustar temporalmente los márgenes a cero
\newgeometry{top=0cm, bottom=0cm, left=0cm, right=0cm, noheadfoot}

% Incluir el archivo PDF de la portada ocupando toda la página sin márgenes
\includepdf[pages=-,pagecommand={}]{Portada.pdf}

% Restaurar la configuración de márgenes original
\restoregeometry

\renewcommand{\listtablename}{Índice de Tablas}
\renewcommand{\tablename}{Tabla}

\frontmatter % Use roman page numbering style (i, ii, iii, iv...) for the pre-content pages

\pagestyle{plain} % Default to the plain heading style until the thesis style is called for the body content

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\begin{titlepage}
\begin{center}

\vspace*{.06\textheight}
{\scshape\LARGE \univname\par}\vspace{1.5cm} % University name
\textsc{\Large Trabajo Fin de Máster}\\[0.5cm] % Thesis type

\HRule \\[0.4cm] % Horizontal line
{\huge \bfseries \ttitle\par}\vspace{0.4cm} % Thesis title
\HRule \\[1.5cm] % Horizontal line
 
\begin{minipage}[t]{0.4\textwidth}
\begin{flushleft} \large
\emph{Autor:}\\
\href{http://www.nuberoja.com}{\authorname} % Author name - remove the \href bracket to remove the link
\end{flushleft}
\end{minipage}
\begin{minipage}[t]{0.4\textwidth}
\begin{flushright} \large
\emph{Director:} \\
\href{https://www.ehu.eus/es/web/gded/koldo}{\supname} % Supervisor name - remove the \href bracket to remove the link  
\end{flushright}
\end{minipage}\\[3cm]
 
\vfill

\large \textit{El presente Trabajo Fin de Máster}\\[0.3cm] % University requirement text
\textit{se ha realizado en el}\\[0.4cm]
\groupname\\[2cm] % Research group name and department name
 
\vfill

{\large \today}\\[4cm] % Date
%\includegraphics{Logo} % University/department logo - uncomment to place it
 
\vfill
\end{center}
\end{titlepage}

\let\cleardoublepage\clearpage 

%----------------------------------------------------------------------------------------
%	QUOTATION PAGE
%----------------------------------------------------------------------------------------

\vspace*{0.2\textheight}

\noindent\enquote{\itshape L'umanità è a un bivio. O torna a credere di avere una natura diversa rispetto alle macchine o sarà ridotta a macchina tra le macchine.}\bigbreak

\hfill Federico Faggin

%----------------------------------------------------------------------------------------
%	RESUMEN CASTELLANO
%----------------------------------------------------------------------------------------

\begin{Resumen}
\addchaptertocentry{\resumenname} % Add the abstract to the table of contents
Para llevar a cabo la inferencia de IA de manera generalizada, se requieren dispositivos de procesamiento que sean energéticamente eficientes, compactos y altamente fiables. 
En este sentido, las arquitecturas de procesamiento heterogéneo, que combinan CPUs personalizadas con coprocesadores de aplicación específica, proporcionan un buen equilibrio entre eficiencia computacional y flexibilidad, resultando adecuadas para desplegar en ellas IA en el borde. 
Además, estas arquitecturas permiten reducir los tiempos de desarrollo en comparación con los procesadores completamente personalizados.
Siguiendo la iniciativa de promover la soberanía europea en el ámbito de la microelectrónica, en este trabajo se propone el uso de una plataforma hardware de código abierto basada en RISC-V, así como de herramientas de Automatización del Diseño Electrónico (EDA) Free/Libres y/o de Código Abierto (FLOS) para evaluar el rendimiento de diferentes opciones de integración de coprocesadores en un Sistema-en-Chip (SoC) prototipado sobre FPGA. 
Se evalúan cuatro opciones de integración (Stream, XBUS, CFS y CFU) con objeto de obtener datos que permitan tomar decisiones de diseño precisas para el desarrollo futuro de dispositivos integrados destinados al procesamiento de alto rendimiento de IA en el borde.
Adicionalmente, se verifica el beneficio de este enfoque comparando, en términos de latencia computacional, el cálculo de la función de activación sigmoide mediante la arquitectura heterogénea propuesta frente al uso exclusivo de la CPU.
Para este propósito, se ha integrado un acelerador basado en el método de Interpolación Recursiva Centrada (CRI) a través de una instrucción personalizada de la extensión ISA Zxcfu, logrando un ratio de aceleración promedio y máximo de 15,25:1 y 21,53:1, respectivamente. 
Estos resultados confirman que la arquitectura distribuida propuesta es capaz de mejorar significativamente el rendimiento en el cálculo de las funciones de activación dentro del contexto de las redes neuronales artificiales (RNAs).
\vspace{2cm}
\end{Resumen}

%----------------------------------------------------------------------------------------
%	RESUMEN EUSKERA
%----------------------------------------------------------------------------------------

\begin{Laburpena}
\addchaptertocentry{\resumennameeus} % Add the abstract to the table of contents
AAren inferentzia modu orokorrean aurrera eramateko, energetikoki eraginkorrak, estrukutralki trinkoak eta erabat fidagarriak diren gailuak ezinbestekoak dira. 
Ildo horretatik, prozesamendu heterogeneoko arkitekturek, PUZ pertsonalizatuak aplikazio espezifikoko koprozesadoreekin konbinatzen dituztenek, oreka egokia lortzen dute eraginkortasun konputazionalaren eta malgutasunaren artean, hortaz, egokiak izanez bertan AA ertzean zabaltzeko. 
Halaber, arkitektura horiek garapen-denborak murriztea ahalbidetzen dute, prozesadore erabat pertsonalizatuekin alderatuta. 
Mikroelektronikaren esparruan Europaren subiranotasuna sustatzeko ekimenari jarraituz, lan honetan RISC-V-an oinarritutako kode irekiko hardware plataforma baten erabilera proposatzen da, baita Diseinu Elektronikoa Automatizatzeko (EDA) tresna Free/Libre eta/edo Kode Irekikoa (FLOS) ere, FPGA-an prototipatutako Txip bidezko Sistema (SoC) batean, koprozesadoreak integratzeko aukera ezberdinen errendimendua ebaluatzeko. 
Lau integrazio aukera (Stream, XBUS, CFS y CFU) ebaluatzen dira datuak eskuratzeko asmoz, AAertzean-aren errendimendu handiko prozesamendurako zuzenduta dauden gailu integratuen etorkizuneko garapenerako diseinu-erabaki zehatzak hartzea ahalbidetzen dituztenak. 
Horrez gain, ikuspegi horren onura egiaztatzen da, proposatutako arkitektura heterogeneoaren bidezko sigmoide akti- bazio-funtzioaren kalkuluaren, eta PUZ-aren erabilera esklusiboaren latentzia konputazionala konparatuz. 
Helburu honetarako, Interpolazio Errekurtsibo Zentratua (CRI) metodoan oinarritutako azeleratzailea integratu da, ISA Zxcfu hedapenaren agindu pertsonalizatu baten bidez, 15,25:1 eta 21,53:1 -ko batazbesteko azelerazio  ratioa eta ratio maximoa lortuz hurrenez hurren. 
Emaitza horiek berresten dute proposatutako arkitektura banatua gai dela neurona-sare artifizialen (RNA) testuinguruan aktibazio-funtzioen kalkuloetan errendimendua nabarmen hobetzeko.
\end{Laburpena}

%----------------------------------------------------------------------------------------
%	RESUMEN INGLES
%----------------------------------------------------------------------------------------

\begin{Abstract}
\addchaptertocentry{\resumennamein} % Add the abstract to the table of contents
Performing AI inference ubiquitously requires energy-efficient, small footprint and highly reliable processing devices. 
Heterogeneous processing architectures combining customized CPUs with domain specific coprocessors can provide a good trade-off between computational efficiency and application flexibility for edge AI deployments while shortening development times compared to full custom application-specific processor designs. 
Following the impulse for the European sovereignty in the microelectronics field, in this work we propose the use of a RISC-V based open-source hardware platform and Free/Libre and/or Open Source (FLOS) Electronic Design Automation (EDA) tools to evaluate the performance of different coprocessor integration options in a System-on-Chip (SoC) prototyped on FPGA. 
We tested four integration options (XBUS, Stream, CFS and CFU) to obtain precise data that will allow making the correct design decisions for the future development of integrated devices for high-performance AI at the edge.
Additionally, the benefit of this approach was verified by comparing the computational latency of the sigmoid activation function calculation using the proposed heterogeneous architecture versus the exclusive use of the CPU.
For this purpose, an accelerator based on the Centered Recursive Interpolation (CRI) method was integrated through a custom instruction of the Zxcfu ISA extension, achieving an average and maximum acceleration ratio of 15.25:1 and 21.53:1, respectively.
These results confirmed that the proposed distributed architecture can significantly improve the performance of activation function calculations within the context of artificial neural networks (ANNs).
\vspace{2cm}
\end{Abstract}

%----------------------------------------------------------------------------------------
%	LIST OF CONTENTS/FIGURES/TABLES PAGES
%----------------------------------------------------------------------------------------

\tableofcontents % Prints the main table of contents
\addchaptertocentry{\contentsname}  % Add the table of contents to the table of contents
\listoffigures % Prints the list of figures
\addchaptertocentry{\listfigurename} % Add the list of figures to the table of contents
\listoftables % Prints the list of tables
\addchaptertocentry{\listtablename} % Add the list of tables to the table of contents
%----------------------------------------------------------------------------------------
%	ABBREVIATIONS
%----------------------------------------------------------------------------------------

\begin{abbreviations}{ll} % Include a list of abbreviations (a table of two columns)
\addchaptertocentry{\abbrevname} % Add the list of abbreviations to the table of contents
\textbf{AI} & \textbf{A}rtificial \textbf{I}ntelligence\\
\textbf{ALU} & \textbf{A}rithmetic \textbf{L}ogic \textbf{U}nit\\
\textbf{ASIC} & \textbf{A}pplication-\textbf{S}pecific \textbf{I}ntegrated \textbf{C}ircuit\\
\textbf{AXI} & \textbf{A}dvanced  e\textbf{X}tensible \textbf{I}nterface\\
\textbf{CFU} & \textbf{C}ustom  \textbf{F}unction \textbf{U}nit\\
\textbf{CFS} & \textbf{C}ustom  \textbf{F}unction \textbf{S}ubsystem\\
\textbf{CI} & \textbf{C}ontinuous \textbf{I}ntegration\\
\textbf{CLI} & \textbf{C}ommand-\textbf{L}ine \textbf{I}nterface\\
\textbf{CNN} & \textbf{C}onvolutional \textbf{N}eural \textbf{N}etwork\\
\textbf{CPU} & \textbf{C}entral  \textbf{P}rocessing \textbf{U}nit\\
\textbf{CRI} & \textbf{C}entered \textbf{R}ecursive \textbf{I}nterpolation\\
\textbf{CSR} & \textbf{C}ontrol and \textbf{S}tatus \textbf{R}egisters\\
\textbf{CSV} & \textbf{C}omma-\textbf{S}eparated \textbf{V}alues\\
\textbf{CXU} & \textbf{C}omposable  e\textbf{X}tension \textbf{U}nit\\
\textbf{DDR} & \textbf{D}ouble \textbf{D}ata \textbf{R}ate\\
\textbf{DRAM} & \textbf{D}ynamic \textbf{R}andom \textbf{A}ccess \textbf{M}emory\\
\textbf{DSP} & \textbf{D}igital \textbf{S}ignal \textbf{P}rocessor\\
\textbf{EDA} & \textbf{E}lectronic \textbf{D}esign \textbf{A}utomation\\
\textbf{ESA} & \textbf{E}uropean  \textbf{S}pace \textbf{A}gency\\
\textbf{FA} & \textbf{F}unción de \textbf{A}ctivación\\
\textbf{FIFO} & \textbf{F}irst  \textbf{I}n \textbf{F}irst \textbf{O}ut\\
\textbf{FLOS} & \textbf{F}ree/\textbf{L}ibre and/or \textbf{O}pen \textbf{S}ource\\
\textbf{FOSS} & \textbf{F}ree and \textbf{O}pen \textbf{S}ource \textbf{S}oftware\\
\textbf{FPGA} & \textbf{F}ield \textbf{P}rogrammable \textbf{G}ate \textbf{A}rrays\\
\textbf{FPGAIF} & \textbf{FPGA} \textbf{I}nterchange \textbf{F}ormat\\
\textbf{FPU} & \textbf{F}loating \textbf{P}oint \textbf{U}nit\\
\textbf{GCC} & \textbf{G}NU \textbf{C}ompiler \textbf{C}ollection\\
\textbf{GDB} & \textbf{G}NU \textbf{D}e\textbf{B}ugger\\
\textbf{HDL} & \textbf{H}ardware  \textbf{D}escription \textbf{L}anguage\\
\textbf{ILA} & \textbf{I}ntegrated \textbf{L}ogic \textbf{A}nalyzer\\
\textbf{IMEM} & \textbf{I}nstruction \textbf{MEM}ory\\
\textbf{ISA} & \textbf{I}nstruction  \textbf{S}et \textbf{A}rchitecture\\
\textbf{IEEE} & \textbf{I}nstitute of \textbf{E}lectrical and \textbf{E}lectronics \textbf{E}ngineers\\    
\textbf{JTAG} & \textbf{J}oint \textbf{T}est \textbf{A}ction \textbf{G}roup\\
\textbf{IA} & \textbf{I}nteligencia \textbf{A}rtificial\\
\textbf{MAC} & \textbf{M}ultiply–\textbf{AC}cumulate\\
\textbf{MLO} & \textbf{M}odified \textbf{L}attice \textbf{O}perators\\
\textbf{MSB} & \textbf{M}ost \textbf{S}ignificant \textbf{B}it\\
\textbf{ODS} & \textbf{O}bjetivos de \textbf{D}esarrollo \textbf{S}ostenible\\
\textbf{OSVVM} & \textbf{O}pen \textbf{S}ource \textbf{V}HDL \textbf{V}erification \textbf{M}ethodology\\
\textbf{PCI} & \textbf{P}eripheral \textbf{C}omponent \textbf{I}nterconnect\\
\textbf{POWER} & \textbf{P}erformance \textbf{O}ptimization \textbf{W}ith \textbf{E}nhanced \textbf{R}ISC\\
\textbf{RAM} & \textbf{R}andom \textbf{A}ccess \textbf{M}emory\\
\textbf{ReLU} & \textbf{Re}ctified \textbf{L}inear \textbf{U}nit\\
\textbf{RNA} & \textbf{R}edes \textbf{N}euronales \textbf{A}rtificiales\\
\textbf{ROM} & \textbf{R}ead \textbf{O}nly \textbf{M}emory\\
\textbf{RTOS} & \textbf{R}eal \textbf{T}ime \textbf{O}perating \textbf{S}ystem\\
\textbf{SATA} & \textbf{S}erial \textbf{A}dvanced \textbf{T}echnology \textbf{A}ttachment\\
\textbf{SDK} & \textbf{S}oftware \textbf{D}evelopment \textbf{K}it\\
\textbf{SLINK} & \textbf{S}tream   \textbf{LINK}  Interface\\
\textbf{SoC} & \textbf{S}ystem  \textbf{o}n a \textbf{C}hip\\ 
\textbf{SPARC} & \textbf{S}calable  \textbf{P}rocessor \textbf{ARC}hitecture\\
\textbf{SPI} & \textbf{S}erial \textbf{P}eripheral \textbf{I}nterface\\
\textbf{TCL} & \textbf{T}ool \textbf{C}ommand \textbf{L}anguage\\
\textbf{UART} & \textbf{U}niversal \textbf{A}synchronous \textbf{R}eceiver-\textbf{T}ransmitter\\
\textbf{UVVM} & \textbf{U}niversal \textbf{V}HDL \textbf{V}erification \textbf{M}ethodology\\
\textbf{VHDL} & \textbf{VHSIC} \textbf{H}ardware \textbf{D}escription \textbf{L}anguage\\
\textbf{VHSIC} & \textbf{V}ery \textbf{H}igh \textbf{S}peed \textbf{I}ntegrated \textbf{C}ircuit\\
\textbf{XBUS} & Processor-E\textbf{X}ternal  \textbf{BUS}  Interface\\
\textbf{XIP} & e\textbf{X}ecute \textbf{I}n-\textbf{P}lace\\
\textbf{YML} & \textbf{Y}AML Ain't \textbf{M}arkup \textbf{L}anguage\\

\end{abbreviations}

%----------------------------------------------------------------------------------------
%	DEDICATION
%----------------------------------------------------------------------------------------

\dedicatory{En agradecimiento a Jon, Koldo, Oscar y Unai miembros de GDED y a Stephan Nolting por su contribución al hardware libre.} 

%----------------------------------------------------------------------------------------
%	THESIS CONTENT - CHAPTERS
%----------------------------------------------------------------------------------------

\mainmatter % Begin numeric (1,2,3...) page numbering

\pagestyle{thesis} % Return the page headers back to the "thesis" style

\include{Capitulos/Memoria}
\include{Capitulos/Desarrollo}
\include{Capitulos/Metodologia} 
\include{Capitulos/Conclusiones}  

%----------------------------------------------------------------------------------------
%	THESIS CONTENT - APPENDICES
%----------------------------------------------------------------------------------------

\appendix % Cue to tell LaTeX that the following "chapters" are Appendices

% Include the appendices of the thesis as separate files from the Appendices folder
% Uncomment the lines as you write the Appendices

\include{Anexos/Articulo}
\include{Anexos/Waveform}
\include{Anexos/Res-Sim}
\include{Anexos/Codigo}

%----------------------------------------------------------------------------------------
%	BIBLIOGRAPHY
%----------------------------------------------------------------------------------------

\printbibliography[heading=bibintoc]

%----------------------------------------------------------------------------------------

\end{document}  
